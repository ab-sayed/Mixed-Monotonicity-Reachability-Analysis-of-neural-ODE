function dx = CTRNN_FPA(x,u)
% # CTRNN FPA example
% # from https://easychair.org/publications/open/K6SZ

x1 = x(1); x2 = x(2); x3 = x(3); x4 = x(4); x5 = x(5);

x1p = (5419046323626097 * (exp(-2 * x3) - 1) ...
    / (4503599627370496 * (exp(-2 * x3) + 1)) ...
    - x1 / 1000000 ...
    + 3601 * (exp(-2 * x4) - 1) / (50000 * (exp(-2 * x4) + 1)) ...
    + 18727 * (exp(-2 * x5) - 1) / (20000 * (exp(-2 * x5) + 1)) ...
);

x2p = (30003 * (exp(-2 * x4) - 1) / (20000 * (exp(-2 * x4) + 1))...
    - 11881 * (exp(-2 * x3) - 1) / (10000 * (exp(-2 * x3) + 1))...
    - x2 / 1000000 ...
    - 93519 * (exp(-2 * x5) - 1) / (100000 * (exp(-2 * x5) + 1))...
);

x3p = (7144123746377831 * (exp(-2 * x3) - 1) ...
    / (4503599627370496 * (exp(-2 * x3) + 1)) ... 
    - x3 / 1000000 ...
    - 5048886837752751 ...
    * (exp(-2 * x4) - 1) ...
    / (72057594037927936 * (exp(-2 * x4) + 1)) ...
    + 5564385670244745 ... 
    * (exp(-2 * x5) - 1) ...
    / (4503599627370496 * (exp(-2 * x5) + 1)) ...
);

x4p = (1348796766312415 ...
    * (exp(-2 * x4) - 1) ...
    / (4503599627370496 * (exp(-2 * x4) + 1)) ...
    - 3086507593514335 ...
    * (exp(-2 * x3) - 1) ...
    / (36028797018963968 * (exp(-2 * x3) + 1)) ...
    - x4 / 1000000 ...
    - 2476184452153819 ...
    * (exp(-2 * x5) - 1) ...
    / (36028797018963968 * (exp(-2 * x5) + 1)) ...
);
x5p = (1523758031023695 ...
    * (exp(-2 * x4) - 1) ...
    / (18014398509481984 * (exp(-2 * x4) + 1)) ...
    - 8060407538855891 ...
    * (exp(-2 * x3) - 1) ...
    / (4503599627370496 * (exp(-2 * x3) + 1)) ...
    - x5 / 1000000 ...
    - 3139112893264555 ...
    * (exp(-2 * x5) - 1) ...
    / (2251799813685248 * (exp(-2 * x5) + 1)) ...
);

dx = [x1p; x2p; x3p; x4p; x5p];

end

